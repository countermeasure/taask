{% load customtags %}

{% if task_id %}
  <td colspan="14" class="task-form" id="task-edit-cell">
    <form role="form" class="form-inline" id="edittaskform"
      action="{% url 'edit-task' task_id %}" method="POST">
{% else %}
  <form role="form" class="form-inline" id="addtaskform"
    action="" method="POST">
{% endif %}
    <div id="form-contents">
      {% csrf_token %}

      <div class="panel panel-default">

        {% ifequal form.view.value 'completed' %}
          <div class="panel-heading panel-heading-warning">
            <i class="fa fa-warning fa-lg"></i>&nbsp;
            You are editing a completed task.
          </div><!-- /.panel-heading -->
        {% endifequal %}

        <div class="panel-heading">
          Basic information
        </div><!-- /.panel-heading -->

        <div class="panel-body">

          <div class="form-group width-80">
            {{ form.description.label_tag|labelclass:"sr-only" }}
              <div class="input-group">
                <div class="input-group-addon">{{ form.description.label }}</div>
                {{ form.description|inputclass:"form-control"|autofocus }}
              </div><!-- /.input-group -->
            {{ form.description.errors }}
          </div><!-- /.form-group -->

          <br>

          <div class="form-group">
            {{ form.view.label_tag|labelclass:"sr-only" }}
            <div class="input-group">
              <div class="input-group-addon">{{ form.view.label }}</div>
              {{ form.view|inputclass:"form-control" }}
            </div><!-- /.input-group -->
            {{ form.view.errors }}
          </div><!-- /.form-group -->

          <div class="form-group">
            {{ form.time_remaining.label_tag|labelclass:"sr-only" }}
            <div class="input-group">
              <div class="input-group-addon">{{ form.time_remaining.label }}</div>
              {{ form.time_remaining|inputclass:"form-control" }}
            </div><!-- /.input-group -->
            {{ form.time_remaining.errors }}
          </div><!-- /.form-group -->

          <div class="form-group">
            {{ form.time_spent.label_tag|labelclass:"sr-only" }}
            <div class="input-group">
              <div class="input-group-addon">{{ form.time_spent.label }}</div>
              {{ form.time_spent|inputclass:"form-control" }}
            </div><!-- /.input-group -->
            {{ form.time_spent.errors }}
          </div><!-- /.form-group -->

          <div class="form-group">
            {{ form.priority.label_tag|labelclass:"sr-only" }}
            <div class="input-group">
              <div class="input-group-addon">{{ form.priority.label }}</div>
              {{ form.priority|inputclass:"form-control" }}
            </div><!-- /.input-group -->
            {{ form.priority.errors }}
          </div><!-- /.form-group -->

          <div class="form-group">
            {{ form.project.label_tag|labelclass:"sr-only" }}
            <div class="input-group">
              <div class="input-group-addon">{{ form.project.label }}</div>
              {{ form.project|inputclass:"form-control" }}
            </div><!-- /.input-group -->
            {{ form.project.errors }}
          </div><!-- /.form-group -->

          <div class="checkbox">
            <label>
              {{ form.underway }}
              {{ form.underway.label }}
              {{ form.underway.errors }}
            </label>
          </div><!-- /.checkbox -->

        </div><!-- /.panel-body -->

        <div class="panel-heading">
          Contexts
        </div><!-- /.panel-heading -->

        <div class="panel-body">

          <div class="form-group">
            {{ form.context.label_tag|labelclass:"sr-only" }}
            <div class="input-group">
              <div class="input-group-addon">{{ form.context.label }}</div>
              {{ form.context|inputclass:"form-control" }}
            </div><!-- /.input-group -->
            {{ form.context.errors }}
          </div><!-- /.form-group -->

        </div><!-- /.panel-body -->

        <div class="panel-heading">
          Notes
        </div><!-- /.panel-heading -->

        <div class="panel-body">

          <div class="form-group">
            {{ form.notes.label_tag|labelclass:"sr-only" }}
            <div class="input-group">
              <div class="input-group-addon">{{ form.notes.label }}</div>
              {{ form.notes|inputclass:"form-control notes"|rows:"3"|cols:"100" }}
            </div><!-- /.input-group -->
            {{ form.notes.errors }}
          </div><!-- /.form-group -->

        </div><!-- /.panel-body -->

        <div class="panel-heading">
          Scheduling
        </div><!-- /.panel-heading -->

        <div class="panel-body">

          <div class="form-group">
            {{ form.deadline.label_tag|labelclass:"sr-only" }}
            <div class="input-group">
              <div class="input-group-addon">{{ form.deadline.label }}</div>
              {{ form.deadline|inputclass:"form-control datepicker" }}
            </div><!-- /.input-group -->
            {{ form.deadline.errors }}
          </div><!-- /.form-group -->

          <div class="form-group">
            {{ form.scheduled.label_tag|labelclass:"sr-only" }}
            <div class="input-group">
              <div class="input-group-addon">{{ form.scheduled.label }}</div>
              {{ form.scheduled|inputclass:"form-control datepicker" }}
            </div><!-- /.input-group -->
            {{ form.scheduled.errors }}
          </div><!-- /.form-group -->

        </div><!-- /.panel-body -->

        <div class="panel-heading">
          For recurring tasks only
        </div><!-- /.panel-heading -->

        <div class="panel-body">

          <div class="form-group">
            {{ form.repeat_units.label_tag|labelclass:"sr-only" }}
            <div class="input-group">
              <div class="input-group-addon">{{ form.repeat_units.label }}</div>
              {{ form.repeat_units|inputclass:"form-control" }}
            </div><!-- /.input-group -->
            {{ form.repeat_units.errors }}
          </div><!-- /.form-group -->

          <div class="form-group">
            {{ form.repeat_every.label_tag|labelclass:"sr-only" }}
            <div class="input-group">
              <div class="input-group-addon">{{ form.repeat_every.label }}</div>
              {{ form.repeat_every|inputclass:"form-control" }}
              <div class="input-group-addon repeat-units"></div>
            </div><!-- /.input-group -->
            {{ form.repeat_every.errors }}
          </div><!-- /.form-group -->

          <div class="form-group hidden" id="repeat-weekly">
            <label class="sr-only" for="id_repeat_weekly">On</label>
            <div class="input-group">
              <div class="input-group-addon">On</div>
              <select id="id_repeat_weekly" class="form-control"
                name="repeat_weekly">
                <option selected="selected" value="monday">Monday</option>
                <option value="tuesday">Tuesday</option>
                <option value="wednesday">Wednesday</option>
                <option value="thursday">Thursday</option>
                <option value="friday">Friday</option>
                <option value="saturday">Saturday</option>
                <option value="sunday">Sunday</option>
              </select>
            </div>
          </div>

          <div class="form-group hidden" id="repeat-monthly">
            <label class="sr-only" for="id_repeat_monthly">Every</label>
            <div class="input-group">
              <div class="input-group-addon">Every</div>
              <select id="id_repeat_monthly" class="form-control"
                name="repeat_monthly">
                <option selected="selected" value="1">1st</option>
                <option value="2">2nd</option>
                <option value="3">3rd</option>
                <option value="4">4th</option>
                <option value="5">5th</option>
                <option value="6">6th</option>
                <option value="7">7th</option>
                <option value="8">8th</option>
                <option value="9">9th</option>
                <option value="10">10th</option>
                <option value="11">11th</option>
                <option value="12">12th</option>
                <option value="13">13th</option>
                <option value="14">14th</option>
                <option value="15">15th</option>
                <option value="16">16th</option>
                <option value="17">17th</option>
                <option value="18">18th</option>
                <option value="19">19th</option>
                <option value="20">20th</option>
                <option value="21">21st</option>
                <option value="22">22nd</option>
                <option value="23">23rd</option>
                <option value="24">24th</option>
                <option value="25">25th</option>
                <option value="26">26th</option>
                <option value="27">27th</option>
                <option value="28">28th</option>
                <option value="29">29th</option>
                <option value="30">30th</option>
                <option value="31">31st</option>
                <option value="0">last day</option>
              </select>
              <div class="input-group-addon">of the month</div>
            </div>
          </div>

          <div class="form-group hidden" id="repeat-yearly">
            <label class="sr-only" for="id_repeat_monthly">Of</label>
            <div class="input-group">
              <div class="input-group-addon">Of</div>
              <select id="id_repeat_monthly" class="form-control"
                name="repeat_monthly">
                <option selected="selected" value="january">January</option>
                <option value="february">February</option>
                <option value="march">March</option>
                <option value="april">April</option>
                <option value="may">May</option>
                <option value="june">June</option>
                <option value="july">July</option>
                <option value="august">August</option>
                <option value="september">September</option>
                <option value="october">October</option>
                <option value="november">November</option>
                <option value="december">December</option>
              </select>
            </div>
          </div>

          <br>

          <div class="form-group">
            {{ form.repeat_next.label_tag|labelclass:"sr-only" }}
            <div class="input-group">
              <div class="input-group-addon">{{ form.repeat_next.label }}</div>
              {{ form.repeat_next|inputclass:"form-control datepicker" }}
            </div><!-- /.input-group -->
            {{ form.repeat_next.errors }}
          </div><!-- /.form-group -->

          <div class="form-group">
            {{ form.repeat_ends.label_tag|labelclass:"sr-only" }}
            <div class="input-group">
              <div class="input-group-addon">{{ form.repeat_ends.label }}</div>
              {{ form.repeat_ends|inputclass:"form-control datepicker" }}
            </div><!-- /.input-group -->
            {{ form.repeat_ends.errors }}
          </div><!-- /.form-group -->

        </div><!-- /.panel-body -->

        <div class="panel-footer clearfix">

          {% if task_id %}
            <a href={% url 'rubbish-task' task_id %} type="button"
              class="btn btn-default">
              <i class="fa fa-trash fa-lg"></i>&nbsp;Move to rubbish
            </a>
            <a href={% url 'complete-task' task_id %} type="button"
                class="btn btn-default">
                <i class="fa fa-check-circle fa-lg"></i>&nbsp;Complete
            </a>
            <a href={% url 'postpone-task' task_id 1 %} type="button"
                class="btn btn-default">
                <i class="fa fa-arrow-circle-right fa-lg"></i>&nbsp;Postpone 1 day
            </a>
          {% endif %}
          <div class="pull-right">
            <a href={% url 'list-tasks' 'view' 'today' %} type="button"
              class="btn btn-default">
              <i class="fa fa-minus-circle fa-lg"></i>&nbsp;Cancel
            </a>
            {% if task_id %}
              <button type="button" class="btn btn-primary btn-save"
                id="save-task-{{ task_id }}">
            {% else %}
              <button type="submit" class="btn btn-primary btn-save">
            {% endif %}
              <i class="fa fa-check-circle fa-lg"></i>&nbsp;Save
            </button>
          </div><!-- /.pull-right -->

        </div><!-- /.panel-footer -->

      </div><!-- /.panel -->
    </div><!-- /.form-contents -->
  </form>
</td>
